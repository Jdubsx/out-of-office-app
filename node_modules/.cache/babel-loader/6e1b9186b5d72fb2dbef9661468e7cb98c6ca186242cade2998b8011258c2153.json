{"ast":null,"code":"import React,{useState}from'react';import{useIsAuthenticated,useMsal}from'@azure/msal-react';import{loginRequest}from'./authConfig';import OutOfOfficeForm from'./components/OutOfOfficeForm';import'./App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const isAuthenticated=useIsAuthenticated();const{instance}=useMsal();const[isLoading,setIsLoading]=useState(false);const handleLogin=()=>{setIsLoading(true);instance.loginPopup(loginRequest).then(response=>{instance.setActiveAccount(response.account);}).catch(e=>{console.error('Login failed:',e);}).finally(()=>{setIsLoading(false);});};const handleLogout=()=>{instance.logoutPopup();};if(!isAuthenticated){return/*#__PURE__*/_jsx(\"div\",{className:\"app\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"app-header\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/alltec-logo.png\",alt:\"Alltec Logo\",style:{height:48,marginRight:16}}),/*#__PURE__*/_jsx(\"span\",{className:\"app-title\",children:\"Alltec Out of Office Manager\"})]}),/*#__PURE__*/_jsx(\"p\",{children:\"Please sign in to manage your out-of-office status\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogin,disabled:isLoading,className:\"login-button\",children:isLoading?'Signing in...':'Sign in with Microsoft'})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"app-header\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/alltec-logo.png\",alt:\"Alltec Logo\",style:{height:48,marginRight:16}}),/*#__PURE__*/_jsx(\"span\",{className:\"app-title\",children:\"Alltec Out of Office Manager\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"logout-button\",children:\"Sign Out\"})]}),/*#__PURE__*/_jsx(\"main\",{className:\"app-main\",children:/*#__PURE__*/_jsx(OutOfOfficeForm,{})})]});}export default App;","map":{"version":3,"names":["React","useState","useIsAuthenticated","useMsal","loginRequest","OutOfOfficeForm","jsx","_jsx","jsxs","_jsxs","App","isAuthenticated","instance","isLoading","setIsLoading","handleLogin","loginPopup","then","response","setActiveAccount","account","catch","e","console","error","finally","handleLogout","logoutPopup","className","children","src","alt","style","height","marginRight","onClick","disabled"],"sources":["C:/Users/j.wenzel/Documents/Programming/Out of Office App/src/App.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useIsAuthenticated, useMsal } from '@azure/msal-react';\r\nimport { loginRequest } from './authConfig';\r\nimport OutOfOfficeForm from './components/OutOfOfficeForm';\r\nimport './App.css';\r\n\r\nfunction App() {\r\n  const isAuthenticated = useIsAuthenticated();\r\n  const { instance } = useMsal();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const handleLogin = () => {\r\n    setIsLoading(true);\r\n    instance.loginPopup(loginRequest)\r\n      .then(response => {\r\n        instance.setActiveAccount(response.account);\r\n      })\r\n      .catch(e => {\r\n        console.error('Login failed:', e);\r\n      })\r\n      .finally(() => {\r\n        setIsLoading(false);\r\n      });\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    instance.logoutPopup();\r\n  };\r\n\r\n  if (!isAuthenticated) {\r\n    return (\r\n      <div className=\"app\">\r\n        <div className=\"login-container\">\r\n          <header className=\"app-header\">\r\n            <img src=\"/alltec-logo.png\" alt=\"Alltec Logo\" style={{ height: 48, marginRight: 16 }} />\r\n            <span className=\"app-title\">Alltec Out of Office Manager</span>\r\n          </header>\r\n          <p>Please sign in to manage your out-of-office status</p>\r\n          <button \r\n            onClick={handleLogin} \r\n            disabled={isLoading}\r\n            className=\"login-button\"\r\n          >\r\n            {isLoading ? 'Signing in...' : 'Sign in with Microsoft'}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"app\">\r\n      <header className=\"app-header\">\r\n        <img src=\"/alltec-logo.png\" alt=\"Alltec Logo\" style={{ height: 48, marginRight: 16 }} />\r\n        <span className=\"app-title\">Alltec Out of Office Manager</span>\r\n        <button onClick={handleLogout} className=\"logout-button\">\r\n          Sign Out\r\n        </button>\r\n      </header>\r\n      <main className=\"app-main\">\r\n        <OutOfOfficeForm />\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App; "],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OAASC,kBAAkB,CAAEC,OAAO,KAAQ,mBAAmB,CAC/D,OAASC,YAAY,KAAQ,cAAc,CAC3C,MAAO,CAAAC,eAAe,KAAM,8BAA8B,CAC1D,MAAO,WAAW,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEnB,QAAS,CAAAC,GAAGA,CAAA,CAAG,CACb,KAAM,CAAAC,eAAe,CAAGT,kBAAkB,CAAC,CAAC,CAC5C,KAAM,CAAEU,QAAS,CAAC,CAAGT,OAAO,CAAC,CAAC,CAC9B,KAAM,CAACU,SAAS,CAAEC,YAAY,CAAC,CAAGb,QAAQ,CAAC,KAAK,CAAC,CAEjD,KAAM,CAAAc,WAAW,CAAGA,CAAA,GAAM,CACxBD,YAAY,CAAC,IAAI,CAAC,CAClBF,QAAQ,CAACI,UAAU,CAACZ,YAAY,CAAC,CAC9Ba,IAAI,CAACC,QAAQ,EAAI,CAChBN,QAAQ,CAACO,gBAAgB,CAACD,QAAQ,CAACE,OAAO,CAAC,CAC7C,CAAC,CAAC,CACDC,KAAK,CAACC,CAAC,EAAI,CACVC,OAAO,CAACC,KAAK,CAAC,eAAe,CAAEF,CAAC,CAAC,CACnC,CAAC,CAAC,CACDG,OAAO,CAAC,IAAM,CACbX,YAAY,CAAC,KAAK,CAAC,CACrB,CAAC,CAAC,CACN,CAAC,CAED,KAAM,CAAAY,YAAY,CAAGA,CAAA,GAAM,CACzBd,QAAQ,CAACe,WAAW,CAAC,CAAC,CACxB,CAAC,CAED,GAAI,CAAChB,eAAe,CAAE,CACpB,mBACEJ,IAAA,QAAKqB,SAAS,CAAC,KAAK,CAAAC,QAAA,cAClBpB,KAAA,QAAKmB,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC9BpB,KAAA,WAAQmB,SAAS,CAAC,YAAY,CAAAC,QAAA,eAC5BtB,IAAA,QAAKuB,GAAG,CAAC,kBAAkB,CAACC,GAAG,CAAC,aAAa,CAACC,KAAK,CAAE,CAAEC,MAAM,CAAE,EAAE,CAAEC,WAAW,CAAE,EAAG,CAAE,CAAE,CAAC,cACxF3B,IAAA,SAAMqB,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAC,8BAA4B,CAAM,CAAC,EACzD,CAAC,cACTtB,IAAA,MAAAsB,QAAA,CAAG,oDAAkD,CAAG,CAAC,cACzDtB,IAAA,WACE4B,OAAO,CAAEpB,WAAY,CACrBqB,QAAQ,CAAEvB,SAAU,CACpBe,SAAS,CAAC,cAAc,CAAAC,QAAA,CAEvBhB,SAAS,CAAG,eAAe,CAAG,wBAAwB,CACjD,CAAC,EACN,CAAC,CACH,CAAC,CAEV,CAEA,mBACEJ,KAAA,QAAKmB,SAAS,CAAC,KAAK,CAAAC,QAAA,eAClBpB,KAAA,WAAQmB,SAAS,CAAC,YAAY,CAAAC,QAAA,eAC5BtB,IAAA,QAAKuB,GAAG,CAAC,kBAAkB,CAACC,GAAG,CAAC,aAAa,CAACC,KAAK,CAAE,CAAEC,MAAM,CAAE,EAAE,CAAEC,WAAW,CAAE,EAAG,CAAE,CAAE,CAAC,cACxF3B,IAAA,SAAMqB,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAC,8BAA4B,CAAM,CAAC,cAC/DtB,IAAA,WAAQ4B,OAAO,CAAET,YAAa,CAACE,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,UAEzD,CAAQ,CAAC,EACH,CAAC,cACTtB,IAAA,SAAMqB,SAAS,CAAC,UAAU,CAAAC,QAAA,cACxBtB,IAAA,CAACF,eAAe,GAAE,CAAC,CACf,CAAC,EACJ,CAAC,CAEV,CAEA,cAAe,CAAAK,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}